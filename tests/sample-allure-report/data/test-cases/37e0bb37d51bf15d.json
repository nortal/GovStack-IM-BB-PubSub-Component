{"uid":"37e0bb37d51bf15d","name":"Given: a manager with a room; When: manager terminates the room with a problem: terminated room; Then: terminating room fails with 404: Room was not found","fullName":"com.govstack.information_mediator.pubsub.api.management.rooms.DeleteRoomTests.Given: a manager with a room; When: manager terminates the room with a problem: #problem; Then: terminating room fails with #statusCode: #message","historyId":"2cb32efeb3bcf9f6ac00ae8d1b9cefe9","time":{"start":1697105189401,"stop":1697105189644,"duration":243},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: a manager with a room","time":{"start":1697105189404,"stop":1697105189404,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105189455,"stop":1697105189461,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO managers(id, identifier_type, identifier, created_at, deleted_at)\nVALUES ('018b235a-1a1c-771b-bc92-d396ab6e4ba3', 'XROAD', 'SANDBOX:ORG:TEST:MANAGER-018b235a-1a19-7170-ad42-2a0d5796b1db', now(), NULL)","time":{"start":1697105189455,"stop":1697105189455,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO managers(id, identifier_type, identifier, created_at, deleted_at)\nVALUES ('018b235a-1a1c-771b-bc92-d396ab6e4ba3', 'XROAD', 'SANDBOX:ORG:TEST:MANAGER-018b235a-1a19-7170-ad42-2a0d5796b1db', now(), NULL)\n"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@543669de"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189462,"stop":1697105189471,"duration":9},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO rooms (id, manager_id, identifier, \"configuration\", journal, deleted_at) VALUES ('018b235a-1a56-7b97-aa60-67e45ffdbd11', '018b235a-1a1c-771b-bc92-d396ab6e4ba3', 'room-018b235a-1a19-7170-ad42-2a0d5796b1db', '{\"messageExpiration\": 0, \"deliveryDelay\": 1, \"deliveryDelayMultiplier\": 1.01, \"deliveryAttempts\": 3}', '[{\"at\": \"2023-10-12T10:06:29.462305700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189462,"stop":1697105189462,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO rooms (id, manager_id, identifier, \"configuration\", journal, deleted_at) VALUES ('018b235a-1a56-7b97-aa60-67e45ffdbd11', '018b235a-1a1c-771b-bc92-d396ab6e4ba3', 'room-018b235a-1a19-7170-ad42-2a0d5796b1db', '{\"messageExpiration\": 0, \"deliveryDelay\": 1, \"deliveryDelayMultiplier\": 1.01, \"deliveryAttempts\": 3}', '[{\"at\": \"2023-10-12T10:06:29.462305700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@3808bdfc"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189472,"stop":1697105189479,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO event_types(id, room_id, identifier, journal, deleted_at) VALUES ('018b235a-1a5f-7fca-a83c-6836d6f2d737', '018b235a-1a56-7b97-aa60-67e45ffdbd11', 'EVENT-018b235a-1a19-7170-ad42-2a0d5796b1db', '[{\"at\": \"2023-10-12T10:06:29.471306200Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189472,"stop":1697105189472,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO event_types(id, room_id, identifier, journal, deleted_at) VALUES ('018b235a-1a5f-7fca-a83c-6836d6f2d737', '018b235a-1a56-7b97-aa60-67e45ffdbd11', 'EVENT-018b235a-1a19-7170-ad42-2a0d5796b1db', '[{\"at\": \"2023-10-12T10:06:29.471306200Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@5f709b99"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189480,"stop":1697105189489,"duration":9},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO event_type_versions (id, event_type_id, \"version\", json_schema, journal, deleted_at) VALUES('018b235a-1a67-7ee4-ad3c-056de6b04c6b', '018b235a-1a5f-7fca-a83c-6836d6f2d737', 1, '{\n   \"$schema\":\"https://json-schema.org/draft/2020-12/schema\",\n   \"$id\":\"https://example.com/event-type.schema.json\",\n   \"title\":\"EVENT-001 Schema\",\n   \"description\":\"Any content\",\n   \"type\":\"object\",\n   \"properties\":{\n      \"payload\":{\n         \"type\":\"string\",\n         \"description\":\"The content of the payload\"\n      }\n   },\n   \"required\":[\n      \"payload\"\n   ]\n}', '[{\"at\": \"2023-10-12T10:06:29.479313400Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189481,"stop":1697105189481,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO event_type_versions (id, event_type_id, \"version\", json_schema, journal, deleted_at) VALUES('018b235a-1a67-7ee4-ad3c-056de6b04c6b', '018b235a-1a5f-7fca-a83c-6836d6f2d737', 1, '{\n   \"$schema\":\"https://json-schema.org/draft/2020-12/schema\",\n   \"$id\":\"https://example.com/event-type.schema.json\",\n   \"title\":\"EVENT-001 Schema\",\n   \"description\":\"Any content\",\n   \"type\":\"object\",\n   \"properties\":{\n      \"payload\":{\n         \"type\":\"string\",\n         \"description\":\"The content of the payload\"\n      }\n   },\n   \"required\":[\n      \"payload\"\n   ]\n}', '[{\"at\": \"2023-10-12T10:06:29.479313400Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@46ebfc09"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189490,"stop":1697105189500,"duration":10},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-1a71-71d9-b7c4-738407508502', '018b235a-1a56-7b97-aa60-67e45ffdbd11', '018b235a-1a5f-7fca-a83c-6836d6f2d737', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-1a19-7170-ad42-2a0d5796b1db', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:29.490303500Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189490,"stop":1697105189490,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-1a71-71d9-b7c4-738407508502', '018b235a-1a56-7b97-aa60-67e45ffdbd11', '018b235a-1a5f-7fca-a83c-6836d6f2d737', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-1a19-7170-ad42-2a0d5796b1db', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:29.490303500Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@21f41593"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189500,"stop":1697105189506,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1a7c-7ef8-a0e9-09d3b5a5ac6c', '018b235a-1a71-71d9-b7c4-738407508502', 'PENDING', now())","time":{"start":1697105189501,"stop":1697105189501,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1a7c-7ef8-a0e9-09d3b5a5ac6c', '018b235a-1a71-71d9-b7c4-738407508502', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@5ceeab0c"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189507,"stop":1697105189512,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1a82-7626-a0e7-cccfbdeffc51', '018b235a-1a71-71d9-b7c4-738407508502', 'ACTIVE', now())","time":{"start":1697105189507,"stop":1697105189507,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1a82-7626-a0e7-cccfbdeffc51', '018b235a-1a71-71d9-b7c4-738407508502', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7194f5b"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189513,"stop":1697105189522,"duration":9},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:29.513079100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-1a71-71d9-b7c4-738407508502'","time":{"start":1697105189514,"stop":1697105189514,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:29.513079100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-1a71-71d9-b7c4-738407508502'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@1e0be005"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189524,"stop":1697105189530,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO publishers (id, room_id, identifier_type, identifier, journal, deleted_at) VALUES ('018b235a-1a92-798b-8404-731a92037806', '018b235a-1a56-7b97-aa60-67e45ffdbd11', 'INTERNAL', 'SANDBOX:ORG:TEST:PUBLISHER-018b235a-1a19-7170-ad42-2a0d5796b1db', '[{\"at\": \"2023-10-12T10:06:29.522902300Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189524,"stop":1697105189524,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO publishers (id, room_id, identifier_type, identifier, journal, deleted_at) VALUES ('018b235a-1a92-798b-8404-731a92037806', '018b235a-1a56-7b97-aa60-67e45ffdbd11', 'INTERNAL', 'SANDBOX:ORG:TEST:PUBLISHER-018b235a-1a19-7170-ad42-2a0d5796b1db', '[{\"at\": \"2023-10-12T10:06:29.522902300Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@1fd226da"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189531,"stop":1697105189538,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO publisher_constraints (id, publisher_id, event_type_id, created_at, deleted_at) VALUES ('018b235a-1a9a-74ae-aef9-8b0e1ed6e925', '018b235a-1a92-798b-8404-731a92037806', '018b235a-1a5f-7fca-a83c-6836d6f2d737', now(), NULL)","time":{"start":1697105189531,"stop":1697105189531,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO publisher_constraints (id, publisher_id, event_type_id, created_at, deleted_at) VALUES ('018b235a-1a9a-74ae-aef9-8b0e1ed6e925', '018b235a-1a92-798b-8404-731a92037806', '018b235a-1a5f-7fca-a83c-6836d6f2d737', now(), NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@36cd58e7"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: manager terminates the room","time":{"start":1697105189539,"stop":1697105189539,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105189540,"stop":1697105189545,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE rooms\nSET deleted_at = now()\nWHERE id = '018b235a-1a56-7b97-aa60-67e45ffdbd11'","time":{"start":1697105189540,"stop":1697105189540,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE rooms\nSET deleted_at = now()\nWHERE id = '018b235a-1a56-7b97-aa60-67e45ffdbd11'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7be3baf2"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:MANAGER-018b235a-1a19-7170-ad42-2a0d5796b1db/room-018b235a-1a19-7170-ad42-2a0d5796b1db","time":{"start":1697105189545,"stop":1697105189609,"duration":64},"status":"passed","steps":[],"attachments":[{"uid":"ffbeccef00476f21","name":"Request","source":"ffbeccef00476f21.html","type":"text/html","size":723},{"uid":"8aef7696a8d7163a","name":"HTTP/1.1 404 ","source":"8aef7696a8d7163a.html","type":"text/html","size":832}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:MANAGER-018b235a-1a19-7170-ad42-2a0d5796b1db"},{"name":"roomId","value":"room-018b235a-1a19-7170-ad42-2a0d5796b1db"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:MANAGER-018b235a-1a19-7170-ad42-2a0d5796b1db"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: terminating room fails","time":{"start":1697105189610,"stop":1697105189610,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105189644,"stop":1697105189644,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":27},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.rooms"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.rooms.DeleteRoomTests"},{"name":"testMethod","value":"Given: a manager with a room; When: manager terminates the room with a problem: terminated room; Then: terminating room fails with 404: Room was not found"},{"name":"suite","value":"DeleteRoomTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC3.10 - Unsuccessful room termination"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"Room was not found"},{"name":"problem","value":"terminated room"},{"name":"statusCode","value":"404"}],"links":[{"name":"M604017-174","url":"https://jira.nortal.com/browse/M604017-174","type":"issue"},{"name":"UC3.10","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"37e0bb37d51bf15d.json","parameterValues":["Room was not found","terminated room","404"]}