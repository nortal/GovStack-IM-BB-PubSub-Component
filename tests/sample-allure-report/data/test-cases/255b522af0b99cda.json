{"uid":"255b522af0b99cda","name":"Given: member's subscription; When: member unsubscribes with problem 'non-existent subscriptionId'; Then: unsubscribe fails with 500","fullName":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests.Given: member's subscription; When: member unsubscribes with problem '#problem'; Then: unsubscribe fails with #statusCode","historyId":"342a372901d61696f81806adbd5b1a76","time":{"start":1697105208873,"stop":1697105209052,"duration":179},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: member's subscription","time":{"start":1697105208939,"stop":1697105208939,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105208940,"stop":1697105208945,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-666b-7595-8228-96520a73f2f4', '018b235a-6656-7d0b-8e12-11585c41dd0a', '018b235a-665c-79d8-b845-d855cb732861', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6629-7cb0-94f1-43bb5f7662a7', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:48.939652900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105208940,"stop":1697105208940,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-666b-7595-8228-96520a73f2f4', '018b235a-6656-7d0b-8e12-11585c41dd0a', '018b235a-665c-79d8-b845-d855cb732861', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6629-7cb0-94f1-43bb5f7662a7', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:48.939652900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@4b3642c4"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208945,"stop":1697105208950,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6671-7db4-8581-aff20606c772', '018b235a-666b-7595-8228-96520a73f2f4', 'PENDING', now())","time":{"start":1697105208945,"stop":1697105208945,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6671-7db4-8581-aff20606c772', '018b235a-666b-7595-8228-96520a73f2f4', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7b2c8390"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208950,"stop":1697105208955,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6676-78f3-838f-361bd2ddc7b4', '018b235a-666b-7595-8228-96520a73f2f4', 'ACTIVE', now())","time":{"start":1697105208950,"stop":1697105208950,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6676-78f3-838f-361bd2ddc7b4', '018b235a-666b-7595-8228-96520a73f2f4', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@16a3060c"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208956,"stop":1697105208961,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:48.956257300Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-666b-7595-8228-96520a73f2f4'","time":{"start":1697105208956,"stop":1697105208956,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:48.956257300Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-666b-7595-8228-96520a73f2f4'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@4242a0e7"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: member unsubscribes with problem","time":{"start":1697105208961,"stop":1697105208961,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6629-7cb0-94f1-43bb5f7662a7/room-018b235a-6629-7cb0-94f1-43bb5f7662a7/subscriptions/non-existent","time":{"start":1697105208964,"stop":1697105209010,"duration":46},"status":"passed","steps":[],"attachments":[{"uid":"e93fc6e37367a470","name":"Request","source":"e93fc6e37367a470.html","type":"text/html","size":789},{"uid":"ca52a8af45ea022e","name":"HTTP/1.1 500 ","source":"ca52a8af45ea022e.html","type":"text/html","size":820}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6629-7cb0-94f1-43bb5f7662a7"},{"name":"roomId","value":"room-018b235a-6629-7cb0-94f1-43bb5f7662a7"},{"name":"subscriptionId","value":"non-existent"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6629-7cb0-94f1-43bb5f7662a7"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: unsubscribe fails","time":{"start":1697105209010,"stop":1697105209010,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105209052,"stop":1697105209052,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":13},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests"},{"name":"testMethod","value":"Given: member's subscription; When: member unsubscribes with problem 'non-existent subscriptionId'; Then: unsubscribe fails with 500"},{"name":"suite","value":"UnsubscribeTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC4.7 - Unsuccessful unsubscribe"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}/subscriptions/{subscriptionId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"Technical error: ([a-f0-9]{8}(-[a-f0-9]{4}){4}[a-f0-9]{8})"},{"name":"problem","value":"non-existent subscriptionId"},{"name":"statusCode","value":"500"}],"links":[{"name":"UC4.7","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"255b522af0b99cda.json","parameterValues":["Technical error: ([a-f0-9]{8}(-[a-f0-9]{4}){4}[a-f0-9]{8})","non-existent subscriptionId","500"]}