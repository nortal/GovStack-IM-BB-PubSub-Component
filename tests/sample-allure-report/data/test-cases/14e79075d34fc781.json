{"uid":"14e79075d34fc781","name":"Given: member's subscription; When: member unsubscribes with problem 'non-existent room'; Then: unsubscribe fails with 404","fullName":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests.Given: member's subscription; When: member unsubscribes with problem '#problem'; Then: unsubscribe fails with #statusCode","historyId":"483cf4b6bea7050ea56d6af3807e4a6e","time":{"start":1697105209241,"stop":1697105209394,"duration":153},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: member's subscription","time":{"start":1697105209304,"stop":1697105209304,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105209305,"stop":1697105209311,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-67d9-7707-9248-64ca17b50fcf', '018b235a-67bf-7622-9840-19c4f0be8a02', '018b235a-67c5-72e8-b702-e2f34e5846fa', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6799-770a-9e3d-280cc9a565ed', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:49.305534400Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105209306,"stop":1697105209306,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-67d9-7707-9248-64ca17b50fcf', '018b235a-67bf-7622-9840-19c4f0be8a02', '018b235a-67c5-72e8-b702-e2f34e5846fa', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6799-770a-9e3d-280cc9a565ed', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:49.305534400Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@29ab7ccc"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105209311,"stop":1697105209316,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-67df-7b0d-9236-232773e5c027', '018b235a-67d9-7707-9248-64ca17b50fcf', 'PENDING', now())","time":{"start":1697105209311,"stop":1697105209311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-67df-7b0d-9236-232773e5c027', '018b235a-67d9-7707-9248-64ca17b50fcf', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@5095f89a"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105209316,"stop":1697105209320,"duration":4},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-67e4-7aff-a661-593f84d1c8be', '018b235a-67d9-7707-9248-64ca17b50fcf', 'ACTIVE', now())","time":{"start":1697105209316,"stop":1697105209316,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-67e4-7aff-a661-593f84d1c8be', '018b235a-67d9-7707-9248-64ca17b50fcf', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@4770e50a"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105209321,"stop":1697105209326,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:49.321325300Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-67d9-7707-9248-64ca17b50fcf'","time":{"start":1697105209321,"stop":1697105209321,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:49.321325300Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-67d9-7707-9248-64ca17b50fcf'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@5f7a911f"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: member unsubscribes with problem","time":{"start":1697105209326,"stop":1697105209326,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6799-770a-9e3d-280cc9a565ed/non-existent/subscriptions/018b235a-67d9-7707-9248-64ca17b50fcf","time":{"start":1697105209326,"stop":1697105209369,"duration":43},"status":"passed","steps":[],"attachments":[{"uid":"38d7cf0d95c11138","name":"Request","source":"38d7cf0d95c11138.html","type":"text/html","size":779},{"uid":"a50c4b03fc9d9494","name":"HTTP/1.1 404 ","source":"a50c4b03fc9d9494.html","type":"text/html","size":832}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6799-770a-9e3d-280cc9a565ed"},{"name":"roomId","value":"non-existent"},{"name":"subscriptionId","value":"018b235a-67d9-7707-9248-64ca17b50fcf"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-6799-770a-9e3d-280cc9a565ed"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: unsubscribe fails","time":{"start":1697105209369,"stop":1697105209369,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105209394,"stop":1697105209394,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":13},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests"},{"name":"testMethod","value":"Given: member's subscription; When: member unsubscribes with problem 'non-existent room'; Then: unsubscribe fails with 404"},{"name":"suite","value":"UnsubscribeTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC4.7 - Unsuccessful unsubscribe"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}/subscriptions/{subscriptionId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"Room was not found"},{"name":"problem","value":"non-existent room"},{"name":"statusCode","value":"404"}],"links":[{"name":"UC4.7","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"14e79075d34fc781.json","parameterValues":["Room was not found","non-existent room","404"]}