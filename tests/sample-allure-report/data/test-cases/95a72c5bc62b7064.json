{"uid":"95a72c5bc62b7064","name":"Given: member's subscription; When: member unsubscribes with problem ''X-Road-Client' header missing'; Then: unsubscribe fails with 403","fullName":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests.Given: member's subscription; When: member unsubscribes with problem '#problem'; Then: unsubscribe fails with #statusCode","historyId":"960e0e91d478f736009fedee41f83ac2","time":{"start":1697105209586,"stop":1697105209836,"duration":250},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: member's subscription","time":{"start":1697105209646,"stop":1697105209646,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105209647,"stop":1697105209652,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-692e-7f10-b998-13a0a7bd7cfd', '018b235a-6918-7fa3-b8a1-92e90c734f6d', '018b235a-691e-7889-9a69-33c9805d1165', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-68f2-751e-9f75-f3ce6348f2f4', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:49.646585700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105209647,"stop":1697105209647,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-692e-7f10-b998-13a0a7bd7cfd', '018b235a-6918-7fa3-b8a1-92e90c734f6d', '018b235a-691e-7889-9a69-33c9805d1165', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-68f2-751e-9f75-f3ce6348f2f4', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:49.646585700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@49bf800f"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105209652,"stop":1697105209656,"duration":4},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6934-765c-9130-e156bd844f21', '018b235a-692e-7f10-b998-13a0a7bd7cfd', 'PENDING', now())","time":{"start":1697105209652,"stop":1697105209652,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6934-765c-9130-e156bd844f21', '018b235a-692e-7f10-b998-13a0a7bd7cfd', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7563ca08"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105209657,"stop":1697105209661,"duration":4},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6938-78b5-bfb6-566f9bc28aa5', '018b235a-692e-7f10-b998-13a0a7bd7cfd', 'ACTIVE', now())","time":{"start":1697105209657,"stop":1697105209657,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6938-78b5-bfb6-566f9bc28aa5', '018b235a-692e-7f10-b998-13a0a7bd7cfd', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@4089505c"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105209661,"stop":1697105209667,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:49.661441500Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-692e-7f10-b998-13a0a7bd7cfd'","time":{"start":1697105209661,"stop":1697105209661,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:49.661441500Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-692e-7f10-b998-13a0a7bd7cfd'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@53fa89e6"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: member unsubscribes with problem","time":{"start":1697105209667,"stop":1697105209667,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-68f2-751e-9f75-f3ce6348f2f4/room-018b235a-68f2-751e-9f75-f3ce6348f2f4/subscriptions/018b235a-692e-7f10-b998-13a0a7bd7cfd","time":{"start":1697105209667,"stop":1697105209717,"duration":50},"status":"passed","steps":[],"attachments":[{"uid":"53e5d0665dfb3081","name":"Request","source":"53e5d0665dfb3081.html","type":"text/html","size":645},{"uid":"b102ad09edfd2a0c","name":"HTTP/1.1 403 ","source":"b102ad09edfd2a0c.html","type":"text/html","size":1058}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-68f2-751e-9f75-f3ce6348f2f4"},{"name":"roomId","value":"room-018b235a-68f2-751e-9f75-f3ce6348f2f4"},{"name":"subscriptionId","value":"018b235a-692e-7f10-b998-13a0a7bd7cfd"},{"name":"header","value":"null"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: unsubscribe fails","time":{"start":1697105209717,"stop":1697105209717,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105209836,"stop":1697105209836,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":13},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests"},{"name":"testMethod","value":"Given: member's subscription; When: member unsubscribes with problem ''X-Road-Client' header missing'; Then: unsubscribe fails with 403"},{"name":"suite","value":"UnsubscribeTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC4.7 - Unsuccessful unsubscribe"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}/subscriptions/{subscriptionId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"Forbidden"},{"name":"problem","value":"'X-Road-Client' header missing"},{"name":"statusCode","value":"403"}],"links":[{"name":"UC4.7","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"95a72c5bc62b7064.json","parameterValues":["Forbidden","'X-Road-Client' header missing","403"]}