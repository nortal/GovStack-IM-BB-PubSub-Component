{"uid":"dd902898b42bbcad","name":"Given: member's PENDING subscription; When: member unsubscribes; Then: unsubscribe succeeds and correct data is saved in DB","fullName":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests.Given: member's #subscriptionStatus subscription; When: member unsubscribes; Then: unsubscribe succeeds and correct data is saved in DB","historyId":"4496ee79f3e89ba285b700e0f2688c02","time":{"start":1697105208462,"stop":1697105208604,"duration":142},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: member's ACTIVE subscription","time":{"start":1697105208519,"stop":1697105208519,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105208519,"stop":1697105208525,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-64c7-79b9-b3b1-0522312b10af', '018b235a-64b5-79dd-831e-e6320a932209', '018b235a-64ba-7c8c-a3db-802157aaf91a', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:48.519690200Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105208519,"stop":1697105208519,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-64c7-79b9-b3b1-0522312b10af', '018b235a-64b5-79dd-831e-e6320a932209', '018b235a-64ba-7c8c-a3db-802157aaf91a', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:48.519690200Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@2f6a923d"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208525,"stop":1697105208530,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-64cd-78c0-a406-6c8a4071489a', '018b235a-64c7-79b9-b3b1-0522312b10af', 'PENDING', now())","time":{"start":1697105208526,"stop":1697105208526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-64cd-78c0-a406-6c8a4071489a', '018b235a-64c7-79b9-b3b1-0522312b10af', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@6cd76b55"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: member unsubscribes","time":{"start":1697105208530,"stop":1697105208530,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb/room-018b235a-648e-7e9c-92b9-9836fda92beb/subscriptions/018b235a-64c7-79b9-b3b1-0522312b10af","time":{"start":1697105208530,"stop":1697105208585,"duration":55},"status":"passed","steps":[{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb/room-018b235a-648e-7e9c-92b9-9836fda92beb/subscriptions/018b235a-64c7-79b9-b3b1-0522312b10af","time":{"start":1697105208530,"stop":1697105208585,"duration":55},"status":"passed","steps":[],"attachments":[{"uid":"3b570a9e0f69fe39","name":"Request","source":"3b570a9e0f69fe39.html","type":"text/html","size":837},{"uid":"b05bf3de556eaa79","name":"HTTP/1.1 200 ","source":"b05bf3de556eaa79.html","type":"text/html","size":646}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb"},{"name":"roomId","value":"room-018b235a-648e-7e9c-92b9-9836fda92beb"},{"name":"subscriptionId","value":"018b235a-64c7-79b9-b3b1-0522312b10af"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0}],"attachments":[],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb"},{"name":"roomId","value":"room-018b235a-648e-7e9c-92b9-9836fda92beb"},{"name":"subscriptionId","value":"018b235a-64c7-79b9-b3b1-0522312b10af"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":1},{"name":"then: unsubscribe succeeds","time":{"start":1697105208585,"stop":1697105208585,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"and: correct data is saved in DB","time":{"start":1697105208586,"stop":1697105208586,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB results","time":{"start":1697105208586,"stop":1697105208599,"duration":13},"status":"passed","steps":[{"name":"DB query","time":{"start":1697105208586,"stop":1697105208599,"duration":13},"status":"passed","steps":[{"name":"Executing SQL query:\n SELECT *\nFROM subscriptions \nWHERE id = '018b235a-64c7-79b9-b3b1-0522312b10af'","time":{"start":1697105208586,"stop":1697105208586,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscriptions \nWHERE id = '018b235a-64c7-79b9-b3b1-0522312b10af'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@39c65cb4"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"Got rows(1):","time":{"start":1697105208599,"stop":1697105208599,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-64c7-79b9-b3b1-0522312b10af, room_id:018b235a-64b5-79dd-831e-e6320a932209, event_type_id:018b235a-64ba-7c8c-a3db-802157aaf91a, identifier_type:XROAD, identifier:SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb, parameters:{\"method\": \"PULL\"}, journal:[{\"at\": \"2023-10-12T10:06:48.519690200Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}, {\"at\": \"2023-10-12T10:06:48.565265500Z\", \"by\": \"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-648e-7e9c-92b9-9836fda92beb\", \"action\": \"MODIFIED\"}], deleted_at:2023-10-12 13:06:48.56481]","time":{"start":1697105208599,"stop":1697105208599,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscriptions \nWHERE id = '018b235a-64c7-79b9-b3b1-0522312b10af'"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":4},{"name":"DB results","time":{"start":1697105208600,"stop":1697105208604,"duration":4},"status":"passed","steps":[{"name":"DB query","time":{"start":1697105208600,"stop":1697105208603,"duration":3},"status":"passed","steps":[{"name":"Executing SQL query:\n SELECT *\nFROM subscription_status ss\nWHERE subscription_id = '018b235a-64c7-79b9-b3b1-0522312b10af'\nORDER BY updated_at DESC","time":{"start":1697105208600,"stop":1697105208600,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscription_status ss\nWHERE subscription_id = '018b235a-64c7-79b9-b3b1-0522312b10af'\nORDER BY updated_at DESC"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@283730de"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"Got rows(2):","time":{"start":1697105208603,"stop":1697105208603,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-64f8-7ad1-9c22-2d2d8ebe04ab, subscription_id:018b235a-64c7-79b9-b3b1-0522312b10af, status:TERMINATED, updated_at:2023-10-12 13:06:48.568645]","time":{"start":1697105208603,"stop":1697105208603,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-64cd-78c0-a406-6c8a4071489a, subscription_id:018b235a-64c7-79b9-b3b1-0522312b10af, status:PENDING, updated_at:2023-10-12 13:06:48.527545]","time":{"start":1697105208603,"stop":1697105208603,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscription_status ss\nWHERE subscription_id = '018b235a-64c7-79b9-b3b1-0522312b10af'\nORDER BY updated_at DESC"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":5},{"name":"where","time":{"start":1697105208604,"stop":1697105208604,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":22},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests"},{"name":"testMethod","value":"Given: member's PENDING subscription; When: member unsubscribes; Then: unsubscribe succeeds and correct data is saved in DB"},{"name":"suite","value":"UnsubscribeTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC4.7 - Successful unsubscribe"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}/subscriptions/{subscriptionId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"subscriptionStatus","value":"PENDING"}],"links":[{"name":"UC4.7","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"dd902898b42bbcad.json","parameterValues":["PENDING"]}