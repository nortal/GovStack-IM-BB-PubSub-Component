{"uid":"f5e95ffdd029907","name":"Given: event type with 1 active PULL subscription; When: message is pulled with problem 'no published message'; Then: pull fails with 404","fullName":"com.govstack.information_mediator.pubsub.api.messaging.PullTests.Given: event type with 1 active PULL subscription; When: message is pulled with problem '#problem'; Then: pull fails with #statusCode","historyId":"d4e4d16e543aa79738d52d9659ea2a4d","time":{"start":1697105225693,"stop":1697105225838,"duration":145},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: event type with 1 active PULL subscription","time":{"start":1697105225757,"stop":1697105225757,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105225758,"stop":1697105225763,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-a81d-7838-a573-76029125a336', '018b235a-a800-770e-a75f-a4b481ea2652', '018b235a-a805-7924-938c-32aef395e871', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:07:05.758202300Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105225758,"stop":1697105225758,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-a81d-7838-a573-76029125a336', '018b235a-a800-770e-a75f-a4b481ea2652', '018b235a-a805-7924-938c-32aef395e871', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:07:05.758202300Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7794926"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105225763,"stop":1697105225767,"duration":4},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-a823-7983-a2bd-781ac40590b6', '018b235a-a81d-7838-a573-76029125a336', 'PENDING', now())","time":{"start":1697105225763,"stop":1697105225763,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-a823-7983-a2bd-781ac40590b6', '018b235a-a81d-7838-a573-76029125a336', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@6d8e8a06"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105225769,"stop":1697105225774,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-a828-7800-a661-e66113d38f2f', '018b235a-a81d-7838-a573-76029125a336', 'ACTIVE', now())","time":{"start":1697105225769,"stop":1697105225769,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-a828-7800-a661-e66113d38f2f', '018b235a-a81d-7838-a573-76029125a336', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@72154fa4"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105225774,"stop":1697105225779,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:07:05.774303800Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-a81d-7838-a573-76029125a336'","time":{"start":1697105225774,"stop":1697105225774,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:07:05.774303800Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-a81d-7838-a573-76029125a336'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@5bc369e8"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: message is pulled with a problem","time":{"start":1697105225779,"stop":1697105225779,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"GET /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9/room-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9/pull","time":{"start":1697105225780,"stop":1697105225838,"duration":58},"status":"passed","steps":[],"attachments":[{"uid":"9709ce0f4b21514c","name":"Request","source":"9709ce0f4b21514c.html","type":"text/html","size":843},{"uid":"6645ca4dbd026079","name":"HTTP/1.1 404 Not Found","source":"6645ca4dbd026079.html","type":"text/html","size":173}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9"},{"name":"roomId","value":"room-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9"},{"name":"subscriptionId","value":"018b235a-a81d-7838-a573-76029125a336"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-a7dd-7c9e-84ec-051bd2b4a5a9"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: pull fails","time":{"start":1697105225838,"stop":1697105225838,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105225838,"stop":1697105225838,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":13},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.messaging"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.messaging.PullTests"},{"name":"testMethod","value":"Given: event type with 1 active PULL subscription; When: message is pulled with problem 'no published message'; Then: pull fails with 404"},{"name":"suite","value":"PullTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC6.3 - Unsuccessful pull"},{"name":"epic","value":"Messaging-api"},{"name":"feature","value":"GET /rooms/{memberId}/{roomId}/pull"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"null"},{"name":"problem","value":"no published message"},{"name":"statusCode","value":"404"}],"links":[{"name":"UC6.3","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"f5e95ffdd029907.json","parameterValues":["null","no published message","404"]}