{"uid":"23abc403d5328979","name":"Given: a manager with a room; When: manager terminates the room with a problem: terminated manager; Then: terminating room fails with 404: Manager was not found","fullName":"com.govstack.information_mediator.pubsub.api.management.rooms.DeleteRoomTests.Given: a manager with a room; When: manager terminates the room with a problem: #problem; Then: terminating room fails with #statusCode: #message","historyId":"a1de2c04f6cf799ff00edb55933f7fba","time":{"start":1697105188265,"stop":1697105188594,"duration":329},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: a manager with a room","time":{"start":1697105188270,"stop":1697105188270,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105188319,"stop":1697105188327,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO managers(id, identifier_type, identifier, created_at, deleted_at)\nVALUES ('018b235a-15af-7287-8d8e-fcdc0cc732a2', 'XROAD', 'SANDBOX:ORG:TEST:MANAGER-018b235a-15a9-7c66-8ea6-6421353ec696', now(), NULL)","time":{"start":1697105188320,"stop":1697105188320,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO managers(id, identifier_type, identifier, created_at, deleted_at)\nVALUES ('018b235a-15af-7287-8d8e-fcdc0cc732a2', 'XROAD', 'SANDBOX:ORG:TEST:MANAGER-018b235a-15a9-7c66-8ea6-6421353ec696', now(), NULL)\n"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@2a62384"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188330,"stop":1697105188338,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO rooms (id, manager_id, identifier, \"configuration\", journal, deleted_at) VALUES ('018b235a-15e8-719c-a66c-52dd031a9219', '018b235a-15af-7287-8d8e-fcdc0cc732a2', 'room-018b235a-15a9-7c66-8ea6-6421353ec696', '{\"messageExpiration\": 0, \"deliveryDelay\": 1, \"deliveryDelayMultiplier\": 1.01, \"deliveryAttempts\": 3}', '[{\"at\": \"2023-10-12T10:06:28.328870500Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105188330,"stop":1697105188330,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO rooms (id, manager_id, identifier, \"configuration\", journal, deleted_at) VALUES ('018b235a-15e8-719c-a66c-52dd031a9219', '018b235a-15af-7287-8d8e-fcdc0cc732a2', 'room-018b235a-15a9-7c66-8ea6-6421353ec696', '{\"messageExpiration\": 0, \"deliveryDelay\": 1, \"deliveryDelayMultiplier\": 1.01, \"deliveryAttempts\": 3}', '[{\"at\": \"2023-10-12T10:06:28.328870500Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@208bde64"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188339,"stop":1697105188346,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO event_types(id, room_id, identifier, journal, deleted_at) VALUES ('018b235a-15f2-7c2f-8603-73aa4994e376', '018b235a-15e8-719c-a66c-52dd031a9219', 'EVENT-018b235a-15a9-7c66-8ea6-6421353ec696', '[{\"at\": \"2023-10-12T10:06:28.339358700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105188340,"stop":1697105188340,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO event_types(id, room_id, identifier, journal, deleted_at) VALUES ('018b235a-15f2-7c2f-8603-73aa4994e376', '018b235a-15e8-719c-a66c-52dd031a9219', 'EVENT-018b235a-15a9-7c66-8ea6-6421353ec696', '[{\"at\": \"2023-10-12T10:06:28.339358700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@c4f6d5b"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188350,"stop":1697105188364,"duration":14},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO event_type_versions (id, event_type_id, \"version\", json_schema, journal, deleted_at) VALUES('018b235a-15fb-7b96-86df-9fe4a9f1f7e7', '018b235a-15f2-7c2f-8603-73aa4994e376', 1, '{\n   \"$schema\":\"https://json-schema.org/draft/2020-12/schema\",\n   \"$id\":\"https://example.com/event-type.schema.json\",\n   \"title\":\"EVENT-001 Schema\",\n   \"description\":\"Any content\",\n   \"type\":\"object\",\n   \"properties\":{\n      \"payload\":{\n         \"type\":\"string\",\n         \"description\":\"The content of the payload\"\n      }\n   },\n   \"required\":[\n      \"payload\"\n   ]\n}', '[{\"at\": \"2023-10-12T10:06:28.348461900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105188351,"stop":1697105188351,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO event_type_versions (id, event_type_id, \"version\", json_schema, journal, deleted_at) VALUES('018b235a-15fb-7b96-86df-9fe4a9f1f7e7', '018b235a-15f2-7c2f-8603-73aa4994e376', 1, '{\n   \"$schema\":\"https://json-schema.org/draft/2020-12/schema\",\n   \"$id\":\"https://example.com/event-type.schema.json\",\n   \"title\":\"EVENT-001 Schema\",\n   \"description\":\"Any content\",\n   \"type\":\"object\",\n   \"properties\":{\n      \"payload\":{\n         \"type\":\"string\",\n         \"description\":\"The content of the payload\"\n      }\n   },\n   \"required\":[\n      \"payload\"\n   ]\n}', '[{\"at\": \"2023-10-12T10:06:28.348461900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@453c10c2"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188368,"stop":1697105188376,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-160d-7d63-a804-2c3b1bcb7e6f', '018b235a-15e8-719c-a66c-52dd031a9219', '018b235a-15f2-7c2f-8603-73aa4994e376', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-15a9-7c66-8ea6-6421353ec696', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:28.367545400Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105188369,"stop":1697105188369,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-160d-7d63-a804-2c3b1bcb7e6f', '018b235a-15e8-719c-a66c-52dd031a9219', '018b235a-15f2-7c2f-8603-73aa4994e376', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-15a9-7c66-8ea6-6421353ec696', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:28.367545400Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@76b5b1e2"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188378,"stop":1697105188384,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1619-7e26-9864-a11a90d5dd92', '018b235a-160d-7d63-a804-2c3b1bcb7e6f', 'PENDING', now())","time":{"start":1697105188379,"stop":1697105188379,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1619-7e26-9864-a11a90d5dd92', '018b235a-160d-7d63-a804-2c3b1bcb7e6f', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@8b329ae"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188385,"stop":1697105188391,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1621-73f6-95ab-68763d485a5d', '018b235a-160d-7d63-a804-2c3b1bcb7e6f', 'ACTIVE', now())","time":{"start":1697105188386,"stop":1697105188386,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1621-73f6-95ab-68763d485a5d', '018b235a-160d-7d63-a804-2c3b1bcb7e6f', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7fe1a856"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188399,"stop":1697105188405,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:28.397780300Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-160d-7d63-a804-2c3b1bcb7e6f'","time":{"start":1697105188400,"stop":1697105188400,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:28.397780300Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-160d-7d63-a804-2c3b1bcb7e6f'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@11f8d64"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188409,"stop":1697105188417,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO publishers (id, room_id, identifier_type, identifier, journal, deleted_at) VALUES ('018b235a-1637-72d9-9194-60385f44964a', '018b235a-15e8-719c-a66c-52dd031a9219', 'INTERNAL', 'SANDBOX:ORG:TEST:PUBLISHER-018b235a-15a9-7c66-8ea6-6421353ec696', '[{\"at\": \"2023-10-12T10:06:28.407889600Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105188410,"stop":1697105188410,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO publishers (id, room_id, identifier_type, identifier, journal, deleted_at) VALUES ('018b235a-1637-72d9-9194-60385f44964a', '018b235a-15e8-719c-a66c-52dd031a9219', 'INTERNAL', 'SANDBOX:ORG:TEST:PUBLISHER-018b235a-15a9-7c66-8ea6-6421353ec696', '[{\"at\": \"2023-10-12T10:06:28.407889600Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@10f03ab0"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105188418,"stop":1697105188425,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO publisher_constraints (id, publisher_id, event_type_id, created_at, deleted_at) VALUES ('018b235a-1641-7342-b653-4e99c934d755', '018b235a-1637-72d9-9194-60385f44964a', '018b235a-15f2-7c2f-8603-73aa4994e376', now(), NULL)","time":{"start":1697105188419,"stop":1697105188419,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO publisher_constraints (id, publisher_id, event_type_id, created_at, deleted_at) VALUES ('018b235a-1641-7342-b653-4e99c934d755', '018b235a-1637-72d9-9194-60385f44964a', '018b235a-15f2-7c2f-8603-73aa4994e376', now(), NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@62a193e0"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: manager terminates the room","time":{"start":1697105188425,"stop":1697105188425,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105188432,"stop":1697105188437,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE managers\nSET deleted_at = now()\nWHERE id = '018b235a-15af-7287-8d8e-fcdc0cc732a2'","time":{"start":1697105188432,"stop":1697105188432,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE managers\nSET deleted_at = now()\nWHERE id = '018b235a-15af-7287-8d8e-fcdc0cc732a2'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@794fbf0d"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:MANAGER-018b235a-15a9-7c66-8ea6-6421353ec696/room-018b235a-15a9-7c66-8ea6-6421353ec696","time":{"start":1697105188438,"stop":1697105188545,"duration":107},"status":"passed","steps":[],"attachments":[{"uid":"ca49c489567353b4","name":"Request","source":"ca49c489567353b4.html","type":"text/html","size":723},{"uid":"a5854eeaa7945135","name":"HTTP/1.1 404 ","source":"a5854eeaa7945135.html","type":"text/html","size":835}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:MANAGER-018b235a-15a9-7c66-8ea6-6421353ec696"},{"name":"roomId","value":"room-018b235a-15a9-7c66-8ea6-6421353ec696"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:MANAGER-018b235a-15a9-7c66-8ea6-6421353ec696"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: terminating room fails","time":{"start":1697105188545,"stop":1697105188545,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105188594,"stop":1697105188594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":27},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.rooms"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.rooms.DeleteRoomTests"},{"name":"testMethod","value":"Given: a manager with a room; When: manager terminates the room with a problem: terminated manager; Then: terminating room fails with 404: Manager was not found"},{"name":"suite","value":"DeleteRoomTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC3.10 - Unsuccessful room termination"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"Manager was not found"},{"name":"problem","value":"terminated manager"},{"name":"statusCode","value":"404"}],"links":[{"name":"M604017-174","url":"https://jira.nortal.com/browse/M604017-174","type":"issue"},{"name":"UC3.10","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"23abc403d5328979.json","parameterValues":["Manager was not found","terminated manager","404"]}