{"uid":"ac8a8c529c485635","name":"Given: member's ACTIVE subscription; When: member unsubscribes; Then: unsubscribe succeeds and correct data is saved in DB","fullName":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests.Given: member's #subscriptionStatus subscription; When: member unsubscribes; Then: unsubscribe succeeds and correct data is saved in DB","historyId":"62a82e0c4480e6abfd3864e527c66c66","time":{"start":1697105208266,"stop":1697105208454,"duration":188},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: member's ACTIVE subscription","time":{"start":1697105208341,"stop":1697105208341,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105208342,"stop":1697105208347,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-6416-775a-b00d-b27a11685659', '018b235a-63fe-7f41-90ea-3337b184c7d4', '018b235a-6405-7751-bce8-b1a5473f00de', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:48.342051900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105208342,"stop":1697105208342,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-6416-775a-b00d-b27a11685659', '018b235a-63fe-7f41-90ea-3337b184c7d4', '018b235a-6405-7751-bce8-b1a5473f00de', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:48.342051900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@7d19d465"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208348,"stop":1697105208353,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-641b-73ae-9e90-dadd59b9d261', '018b235a-6416-775a-b00d-b27a11685659', 'PENDING', now())","time":{"start":1697105208348,"stop":1697105208348,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-641b-73ae-9e90-dadd59b9d261', '018b235a-6416-775a-b00d-b27a11685659', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@bc35e84"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208354,"stop":1697105208358,"duration":4},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6422-786e-981e-f5692defae78', '018b235a-6416-775a-b00d-b27a11685659', 'ACTIVE', now())","time":{"start":1697105208354,"stop":1697105208354,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-6422-786e-981e-f5692defae78', '018b235a-6416-775a-b00d-b27a11685659', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@2d589ced"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105208358,"stop":1697105208362,"duration":4},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:48.358253100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-6416-775a-b00d-b27a11685659'","time":{"start":1697105208358,"stop":1697105208358,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:48.358253100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-6416-775a-b00d-b27a11685659'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@6b1293a5"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: member unsubscribes","time":{"start":1697105208363,"stop":1697105208363,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb/room-018b235a-63cb-72bc-9ead-1927873405bb/subscriptions/018b235a-6416-775a-b00d-b27a11685659","time":{"start":1697105208364,"stop":1697105208431,"duration":67},"status":"passed","steps":[{"name":"DELETE /rooms/SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb/room-018b235a-63cb-72bc-9ead-1927873405bb/subscriptions/018b235a-6416-775a-b00d-b27a11685659","time":{"start":1697105208365,"stop":1697105208431,"duration":66},"status":"passed","steps":[],"attachments":[{"uid":"2155ca7ccbe92e24","name":"Request","source":"2155ca7ccbe92e24.html","type":"text/html","size":837},{"uid":"1826e11cfa57ac49","name":"HTTP/1.1 200 ","source":"1826e11cfa57ac49.html","type":"text/html","size":646}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb"},{"name":"roomId","value":"room-018b235a-63cb-72bc-9ead-1927873405bb"},{"name":"subscriptionId","value":"018b235a-6416-775a-b00d-b27a11685659"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0}],"attachments":[],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb"},{"name":"roomId","value":"room-018b235a-63cb-72bc-9ead-1927873405bb"},{"name":"subscriptionId","value":"018b235a-6416-775a-b00d-b27a11685659"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":1},{"name":"then: unsubscribe succeeds","time":{"start":1697105208431,"stop":1697105208432,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"and: correct data is saved in DB","time":{"start":1697105208432,"stop":1697105208432,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB results","time":{"start":1697105208433,"stop":1697105208445,"duration":12},"status":"passed","steps":[{"name":"DB query","time":{"start":1697105208433,"stop":1697105208444,"duration":11},"status":"passed","steps":[{"name":"Executing SQL query:\n SELECT *\nFROM subscriptions \nWHERE id = '018b235a-6416-775a-b00d-b27a11685659'","time":{"start":1697105208433,"stop":1697105208433,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscriptions \nWHERE id = '018b235a-6416-775a-b00d-b27a11685659'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@712a6e68"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"Got rows(1):","time":{"start":1697105208444,"stop":1697105208444,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-6416-775a-b00d-b27a11685659, room_id:018b235a-63fe-7f41-90ea-3337b184c7d4, event_type_id:018b235a-6405-7751-bce8-b1a5473f00de, identifier_type:XROAD, identifier:SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb, parameters:{\"method\": \"PULL\"}, journal:[{\"at\": \"2023-10-12T10:06:48.342051900Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}, {\"at\": \"2023-10-12T10:06:48.358253100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}, {\"at\": \"2023-10-12T10:06:48.412602300Z\", \"by\": \"SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-63cb-72bc-9ead-1927873405bb\", \"action\": \"MODIFIED\"}], deleted_at:2023-10-12 13:06:48.411631]","time":{"start":1697105208445,"stop":1697105208445,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscriptions \nWHERE id = '018b235a-6416-775a-b00d-b27a11685659'"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":4},{"name":"DB results","time":{"start":1697105208447,"stop":1697105208452,"duration":5},"status":"passed","steps":[{"name":"DB query","time":{"start":1697105208447,"stop":1697105208452,"duration":5},"status":"passed","steps":[{"name":"Executing SQL query:\n SELECT *\nFROM subscription_status ss\nWHERE subscription_id = '018b235a-6416-775a-b00d-b27a11685659'\nORDER BY updated_at DESC","time":{"start":1697105208447,"stop":1697105208447,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscription_status ss\nWHERE subscription_id = '018b235a-6416-775a-b00d-b27a11685659'\nORDER BY updated_at DESC"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@76494bed"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"Got rows(3):","time":{"start":1697105208452,"stop":1697105208452,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-6460-77af-a079-397dceed7ed5, subscription_id:018b235a-6416-775a-b00d-b27a11685659, status:TERMINATED, updated_at:2023-10-12 13:06:48.416766]","time":{"start":1697105208452,"stop":1697105208452,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-6422-786e-981e-f5692defae78, subscription_id:018b235a-6416-775a-b00d-b27a11685659, status:ACTIVE, updated_at:2023-10-12 13:06:48.355805]","time":{"start":1697105208452,"stop":1697105208452,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"[id:018b235a-641b-73ae-9e90-dadd59b9d261, subscription_id:018b235a-6416-775a-b00d-b27a11685659, status:PENDING, updated_at:2023-10-12 13:06:48.349919]","time":{"start":1697105208452,"stop":1697105208452,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"SELECT *\nFROM subscription_status ss\nWHERE subscription_id = '018b235a-6416-775a-b00d-b27a11685659'\nORDER BY updated_at DESC"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":6},{"name":"where","time":{"start":1697105208453,"stop":1697105208453,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":27},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.subscriptions.UnsubscribeTests"},{"name":"testMethod","value":"Given: member's ACTIVE subscription; When: member unsubscribes; Then: unsubscribe succeeds and correct data is saved in DB"},{"name":"suite","value":"UnsubscribeTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC4.7 - Successful unsubscribe"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}/subscriptions/{subscriptionId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"subscriptionStatus","value":"ACTIVE"}],"links":[{"name":"UC4.7","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"ac8a8c529c485635.json","parameterValues":["ACTIVE"]}