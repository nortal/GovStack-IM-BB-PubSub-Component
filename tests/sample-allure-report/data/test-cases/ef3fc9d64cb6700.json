{"uid":"ef3fc9d64cb6700","name":"Given: a manager with a room; When: manager terminates the room with a problem: non-existent room; Then: terminating room fails with 404: Room was not found","fullName":"com.govstack.information_mediator.pubsub.api.management.rooms.DeleteRoomTests.Given: a manager with a room; When: manager terminates the room with a problem: #problem; Then: terminating room fails with #statusCode: #message","historyId":"9152307e97524782df5d5db6dffcb305","time":{"start":1697105189106,"stop":1697105189377,"duration":271},"status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"passed","steps":[{"name":"given: a manager with a room","time":{"start":1697105189109,"stop":1697105189110,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DB query","time":{"start":1697105189153,"stop":1697105189164,"duration":11},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO managers(id, identifier_type, identifier, created_at, deleted_at)\nVALUES ('018b235a-18f6-7dbe-a1b1-2ecee2c65af2', 'XROAD', 'SANDBOX:ORG:TEST:MANAGER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', now(), NULL)","time":{"start":1697105189153,"stop":1697105189153,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO managers(id, identifier_type, identifier, created_at, deleted_at)\nVALUES ('018b235a-18f6-7dbe-a1b1-2ecee2c65af2', 'XROAD', 'SANDBOX:ORG:TEST:MANAGER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', now(), NULL)\n"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@6b5e8b3a"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189164,"stop":1697105189174,"duration":10},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO rooms (id, manager_id, identifier, \"configuration\", journal, deleted_at) VALUES ('018b235a-192c-7b3b-b6e2-505d0dbe8bbd', '018b235a-18f6-7dbe-a1b1-2ecee2c65af2', 'room-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '{\"messageExpiration\": 0, \"deliveryDelay\": 1, \"deliveryDelayMultiplier\": 1.01, \"deliveryAttempts\": 3}', '[{\"at\": \"2023-10-12T10:06:29.164402700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189165,"stop":1697105189165,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO rooms (id, manager_id, identifier, \"configuration\", journal, deleted_at) VALUES ('018b235a-192c-7b3b-b6e2-505d0dbe8bbd', '018b235a-18f6-7dbe-a1b1-2ecee2c65af2', 'room-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '{\"messageExpiration\": 0, \"deliveryDelay\": 1, \"deliveryDelayMultiplier\": 1.01, \"deliveryAttempts\": 3}', '[{\"at\": \"2023-10-12T10:06:29.164402700Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@3c657771"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189175,"stop":1697105189182,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO event_types(id, room_id, identifier, journal, deleted_at) VALUES ('018b235a-1936-711d-aa68-962043bbcbe6', '018b235a-192c-7b3b-b6e2-505d0dbe8bbd', 'EVENT-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '[{\"at\": \"2023-10-12T10:06:29.174759Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189175,"stop":1697105189175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO event_types(id, room_id, identifier, journal, deleted_at) VALUES ('018b235a-1936-711d-aa68-962043bbcbe6', '018b235a-192c-7b3b-b6e2-505d0dbe8bbd', 'EVENT-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '[{\"at\": \"2023-10-12T10:06:29.174759Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@171b82ea"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189182,"stop":1697105189190,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO event_type_versions (id, event_type_id, \"version\", json_schema, journal, deleted_at) VALUES('018b235a-193e-7976-bb8d-4d4a42880a89', '018b235a-1936-711d-aa68-962043bbcbe6', 1, '{\n   \"$schema\":\"https://json-schema.org/draft/2020-12/schema\",\n   \"$id\":\"https://example.com/event-type.schema.json\",\n   \"title\":\"EVENT-001 Schema\",\n   \"description\":\"Any content\",\n   \"type\":\"object\",\n   \"properties\":{\n      \"payload\":{\n         \"type\":\"string\",\n         \"description\":\"The content of the payload\"\n      }\n   },\n   \"required\":[\n      \"payload\"\n   ]\n}', '[{\"at\": \"2023-10-12T10:06:29.182763300Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189183,"stop":1697105189183,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO event_type_versions (id, event_type_id, \"version\", json_schema, journal, deleted_at) VALUES('018b235a-193e-7976-bb8d-4d4a42880a89', '018b235a-1936-711d-aa68-962043bbcbe6', 1, '{\n   \"$schema\":\"https://json-schema.org/draft/2020-12/schema\",\n   \"$id\":\"https://example.com/event-type.schema.json\",\n   \"title\":\"EVENT-001 Schema\",\n   \"description\":\"Any content\",\n   \"type\":\"object\",\n   \"properties\":{\n      \"payload\":{\n         \"type\":\"string\",\n         \"description\":\"The content of the payload\"\n      }\n   },\n   \"required\":[\n      \"payload\"\n   ]\n}', '[{\"at\": \"2023-10-12T10:06:29.182763300Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@49d5db99"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189191,"stop":1697105189199,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-1946-7182-97d1-0b69772db84b', '018b235a-192c-7b3b-b6e2-505d0dbe8bbd', '018b235a-1936-711d-aa68-962043bbcbe6', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:29.191518500Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189192,"stop":1697105189192,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscriptions (id, room_id, event_type_id, identifier_type, identifier, parameters, journal, deleted_at) VALUES ('018b235a-1946-7182-97d1-0b69772db84b', '018b235a-192c-7b3b-b6e2-505d0dbe8bbd', '018b235a-1936-711d-aa68-962043bbcbe6', 'XROAD', 'SANDBOX:ORG:TEST:SUBSCRIBER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '{\"method\":\"PULL\"}', '[{\"at\": \"2023-10-12T10:06:29.191518500Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@564d9ec2"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189199,"stop":1697105189206,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-194f-7b54-97a5-55f8b5e9d822', '018b235a-1946-7182-97d1-0b69772db84b', 'PENDING', now())","time":{"start":1697105189200,"stop":1697105189200,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-194f-7b54-97a5-55f8b5e9d822', '018b235a-1946-7182-97d1-0b69772db84b', 'PENDING', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@4104b585"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189207,"stop":1697105189213,"duration":6},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1957-71ac-9379-f8df002840a3', '018b235a-1946-7182-97d1-0b69772db84b', 'ACTIVE', now())","time":{"start":1697105189207,"stop":1697105189207,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO subscription_status (id, subscription_id, status, updated_at) VALUES ('018b235a-1957-71ac-9379-f8df002840a3', '018b235a-1946-7182-97d1-0b69772db84b', 'ACTIVE', now())"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@ac3739d"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189215,"stop":1697105189222,"duration":7},"status":"passed","steps":[{"name":"Executing SQL query:\n UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:29.214092100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-1946-7182-97d1-0b69772db84b'","time":{"start":1697105189215,"stop":1697105189215,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"UPDATE subscriptions\nSET journal = journal || '[{\"at\": \"2023-10-12T10:06:29.214092100Z\", \"by\": \"TESTS\", \"action\": \"MODIFIED\"}]'::JSONB\nWHERE id = '018b235a-1946-7182-97d1-0b69772db84b'"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@6dad684f"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189223,"stop":1697105189231,"duration":8},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO publishers (id, room_id, identifier_type, identifier, journal, deleted_at) VALUES ('018b235a-1966-7e3a-b99b-d5490f396ea8', '018b235a-192c-7b3b-b6e2-505d0dbe8bbd', 'INTERNAL', 'SANDBOX:ORG:TEST:PUBLISHER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '[{\"at\": \"2023-10-12T10:06:29.222767600Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)","time":{"start":1697105189223,"stop":1697105189223,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO publishers (id, room_id, identifier_type, identifier, journal, deleted_at) VALUES ('018b235a-1966-7e3a-b99b-d5490f396ea8', '018b235a-192c-7b3b-b6e2-505d0dbe8bbd', 'INTERNAL', 'SANDBOX:ORG:TEST:PUBLISHER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4', '[{\"at\": \"2023-10-12T10:06:29.222767600Z\", \"by\": \"TESTS\", \"action\": \"CREATED\"}]', NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@572c50b6"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"DB query","time":{"start":1697105189232,"stop":1697105189241,"duration":9},"status":"passed","steps":[{"name":"Executing SQL query:\n INSERT INTO publisher_constraints (id, publisher_id, event_type_id, created_at, deleted_at) VALUES ('018b235a-196f-79fd-af4d-b2baf1a7b0c2', '018b235a-1966-7e3a-b99b-d5490f396ea8', '018b235a-1936-711d-aa68-962043bbcbe6', now(), NULL)","time":{"start":1697105189233,"stop":1697105189233,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[{"name":"query","value":"INSERT INTO publisher_constraints (id, publisher_id, event_type_id, created_at, deleted_at) VALUES ('018b235a-196f-79fd-af4d-b2baf1a7b0c2', '018b235a-1966-7e3a-b99b-d5490f396ea8', '018b235a-1936-711d-aa68-962043bbcbe6', now(), NULL)"},{"name":"executionMethod","value":"org.codehaus.groovy.runtime.MethodClosure@33606f4b"}],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"stepsCount":1},{"name":"when: manager terminates the room","time":{"start":1697105189241,"stop":1697105189241,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"DELETE /rooms/SANDBOX:ORG:TEST:MANAGER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4/non-existent","time":{"start":1697105189241,"stop":1697105189335,"duration":94},"status":"passed","steps":[],"attachments":[{"uid":"bdd2f8d78b72ad35","name":"Request","source":"bdd2f8d78b72ad35.html","type":"text/html","size":665},{"uid":"75b1266a9309a698","name":"HTTP/1.1 404 ","source":"75b1266a9309a698.html","type":"text/html","size":831}],"parameters":[{"name":"memberId","value":"SANDBOX:ORG:TEST:MANAGER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4"},{"name":"roomId","value":"non-existent"},{"name":"header","value":"X-Road-Client=SANDBOX:ORG:TEST:MANAGER-018b235a-18f2-7c31-bbe1-ae4d6c6003d4"}],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":0},{"name":"then: terminating room fails","time":{"start":1697105189335,"stop":1697105189335,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0},{"name":"where","time":{"start":1697105189376,"stop":1697105189376,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"stepsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"stepsCount":25},"afterStages":[],"labels":[{"name":"package","value":"com.govstack.information_mediator.pubsub.api.management.rooms"},{"name":"testClass","value":"com.govstack.information_mediator.pubsub.api.management.rooms.DeleteRoomTests"},{"name":"testMethod","value":"Given: a manager with a room; When: manager terminates the room with a problem: non-existent room; Then: terminating room fails with 404: Room was not found"},{"name":"suite","value":"DeleteRoomTests"},{"name":"host","value":"lenovo1765"},{"name":"thread","value":"28024@lenovo1765.Test worker(1)"},{"name":"framework","value":"spock"},{"name":"language","value":"java"},{"name":"parentSuite","value":"GenericSpecification"},{"name":"story","value":"UC3.10 - Unsuccessful room termination"},{"name":"epic","value":"Management-api"},{"name":"feature","value":"DELETE /rooms/{memberId}/{roomId}"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"message","value":"Room was not found"},{"name":"problem","value":"non-existent room"},{"name":"statusCode","value":"404"}],"links":[{"name":"M604017-174","url":"https://jira.nortal.com/browse/M604017-174","type":"issue"},{"name":"UC3.10","type":"tms"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"ef3fc9d64cb6700.json","parameterValues":["Room was not found","non-existent room","404"]}